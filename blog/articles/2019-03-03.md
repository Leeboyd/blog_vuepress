è¸©é›·ç´€éŒ„ï¼šVuepress å®¹å™¨åŒ– 
===

###### tags: `è¸©é›·`, `Vuepress`, `docker`


## Vuepress å¾ 0.14.x å‡ç´šåˆ° 1.x

### global å¥—ä»¶å‡ç´š
* `yarn global add vuepress@next`
* æˆ–è€… `npm install -g vuepress@next`

### ğŸ’£ å®¹å™¨é–‹ç™¼
åŸºæœ¬ä¸Šä¸€èˆ¬é–‹ç™¼ï¼Œä¹Ÿå°±æ˜¯é›»è…¦æœ‰ node ç’°å¢ƒï¼Œé€™æ¨£å°±å¯ä»¥ç„¡ç—›è½‰ç§»ï¼Œä½†æœ€è¿‘æ¥è§¸ docker ï¼Œæƒ³è©¦è©¦åœ¨ç„¡ node ç’°å¢ƒçš„ä¸‹åšé–‹ç™¼ï¼Œæ–¼æ˜¯å°‡å°ˆæ¡ˆæ‰“åŒ…åˆ° container


#### Dockerfile
```
FROM node:11-alpine

RUN mkdir -p /home/blog
WORKDIR /home/blog
VOLUME /home/blog

RUN npm install -g vuepress@next

COPY . .

RUN npm install

EXPOSE 9898

CMD yarn blog:dev
```

#### Docker æŒ‡ä»¤

```bash
# build
docker build -t blog:dev

# tag
docker tag blog:dev boylee0101/blog:latest

# push
docker push boylee0101/blog:latest

# run (å¦ä¸€å°é›»è…¦)
docker run -dit --name blog_dev \
-p 9898:9898 \
-v $(pwd)/:/home/blog boylee0101/blog
```  

Build and Runï¼Œç„¶å¾Œç€è¦½å™¨æ‰“é–‹ __localhost:9898__ ï¼Œ**ç†è«–ä¸Š** æ‡‰è©²å°±å¯ä»¥é€£åˆ° container å…§ dev server çš„é é¢ï¼Œä½†å¾—åˆ°çš„å»æ˜¯ä¸€ç‰‡ç©ºç™½...

### Debug

:::warning ç›®å‰ç‹€æ…‹ï¼š
æœªè§£ï¼Œé™å› 0.14.x
:::

1. æª¢æŸ¥ container å…§ dev server æ˜¯å¦é‹ä½œä¸­
    - docker logs blog_dev

    ![2019-03-04 01 43 45](https://user-images.githubusercontent.com/15153292/53699036-0f1d5680-3e1f-11e9-928a-08518b9ac5a7.png)

    - docker exec -it blog_dev sh
    
    é€²å…¥ container å…§ï¼Œä¸‹ `curl 127.0.0.1:9898`ï¼Œä¹Ÿç¢ºå¯¦å¾—åˆ°é¦–é çš„ HTML

2. å„ç¨® try error
    - âŒ æ‹¿ 0.14.x ç‰ˆçš„ containerï¼Œé€²å…¥ container å…§å‡ç´šï¼Œå†æ‰“é–‹ dev server
    - âŒ ç™¼ç¾ docker run æ™‚ï¼Œçœ‹ `logs` dev server ä»åœ¨ç·¨è­¯ï¼Œç•°æƒ³å¤©é–‹æŠŠ CMD é‚£æ®µå»æ‰ï¼Œé€²å…¥ container å…§æ‰‹å‹•é–‹ dev server
    - âŒ æŠŠ CMD æ›æˆ ENTRYPOINT

3. æœªå˜—è©¦éæ–¹å¼
    - â“é‡é–‹ä¸€å€‹å…¨æ–°çš„ 1.0 å°ˆæ¡ˆ
    - â“ä¸ç›´æ¥ proxy åˆ° dev serverï¼ŒåŠ ä¸€å±¤ nginx åš reverse proxy


## markdown-it æ“´å……èªæ³•

1. å®‰è£éœ€è¦çš„ plug-in

```sh
npm install --save markdown-it-checkbox markdown-it-footnote markdown-it-mark markdown-it-task
```

2. ä¿®æ”¹ .vuepress/config.js

```js
module.exports = {
  ...
  markdown: {
    config: md => {
      md.use(require('markdown-it-checkbox')),
      md.use(require('markdown-it-footnote')),
      md.use(require('markdown-it-mark')),
      md.use(require('markdown-it-task-checkbox'))
    }
  }
}
```

### å¯¦é©—èªæ³•

| __markdown-it-mark__ | __èªæ³•__ |
| :---: | :---: |
| `==è¢å…‰ç­†==` | ==è¢å…‰ç­†== |
| __markdown-it-checkbox__ | __èªæ³•__ |
| `[ ] æœªé¸æ“‡` | [ ] æœªé¸æ“‡   |
| `[x] å·²é¸æ“‡` | [x] å·²é¸æ“‡   |
| __markdown-it-underline__ | __èªæ³•__ |
| `_åº•ç·š_` | _åº•ç·š_ |
| __markdown-it-footnote__ | __èªæ³•__ |
| `è¨»è§£[^test]` | è¨»è§£[^test] |


ç„¶å¾Œæ–‡ä»¶ä¸­è¼¸å…¥ä»¥ä¸‹èªæ³•ï¼Œé€™æ®µæ–‡å­—æœƒ render åˆ°æ–‡æœ«ï¼Œé»æ“Šè¨»è§£ä¸Šæ¨™é é¢æ²åˆ°è¨»è§£è™•

```bash
[^test]: é€™æ®µæ–‡å­—æœƒé¡¯ç¤ºåœ¨æ–‡æœ«ï¼Œçœ‹å®Œé»å°¾å·´çš„ç®­é ­è¿”å›ã€‚
```

[^test]: é€™æ®µæ–‡å­—æœƒé¡¯ç¤ºåœ¨æ–‡æœ«ï¼Œçœ‹å®Œé»å°¾å·´çš„ç®­é ­è¿”å›ã€‚


### ğŸ’£ å®¹å™¨é–‹ç™¼

åœ¨ç„¡ node çš„ç’°å¢ƒï¼Œç›´æ¥ä½¿ç”¨ä¸Šé¢çš„ [Dockerfile](/articles/2019-03-03.html#dockerfile) æ˜¯ä¸æœƒæˆåŠŸé–‹å•Ÿ dev server çš„ï¼Œç•¶ docker run çš„æ™‚å€™ï¼Œå®¹å™¨å¤–çš„å°ˆæ¡ˆ `node_modules` æ²’æœ‰ç›¸é—œçš„ plug-inï¼Œæ­¤æ™‚ container æ›ä¸Š host ä¸Šçš„ç¡¬ç¢Ÿï¼Œä¸€ç¶“åŒæ­¥ï¼Œcontainer å…§ `node_modules` å°±ç©ºäº†ï¼Œæ‰€ä»¥å ±éŒ¯ã€‚

### Debug

:::warning ç›®å‰ç‹€æ…‹ï¼š
æœªè§£ï¼Œé€™ä¸æ˜¯å¥½æ–¹æ³•
:::

#### è§£æ±º volume åŒæ­¥é †åºå•é¡Œ
1. [Dockerfile](/articles/2019-03-03.html#dockerfile) ç§»é™¤ CMD
2. é‡æ–° build
3. é€²å…¥å®¹å™¨ï¼Œä¸‹ npm install
4. æ­¤æ™‚ï¼Œå¯ä»¥çœ‹åˆ° host ä¸Šçš„ `node_modules` é€éå®¹å™¨å…§çš„ npm è£å¥½å¥—ä»¶äº†
5. é–‹å•Ÿ dev server
6. `Ctrl` + `P` + `Q` é›¢é–‹å®¹å™¨

> ~~é‚„æ˜¯ç›´æ¥è£ node ç’°å¢ƒï¼Œæœ¬åœ° npm install å§...~~

<div class="page-nav">
  <p class="inner">
    <span class="prev">
      â† <a href="/blog_vuepress/articles/" class="prev router-link-active">
          å›æ–‡ç« åˆ—è¡¨
        </a>
    </span>
    <!-- <span class="next">
      <a href="/blog/tags/" class="">
          Blog Posts by Tag
      </a>
        â†’
    </span> -->
  </p>
</div>