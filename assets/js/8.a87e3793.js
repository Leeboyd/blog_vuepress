(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{62:function(t,s,e){"use strict";e.r(s);var a=e(0),n=Object(a.a)({},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"content"},[t._m(0),t._v(" "),t._m(1),t._v(" "),t._m(2),t._v(" "),t._m(3),t._m(4),t._v(" "),t._m(5),t._m(6),t._v(" "),t._m(7),t._v(" "),e("p",[t._v("關閉 root ssh 登入")]),t._v(" "),t._m(8),t._v(" "),t._m(9),t._m(10),t._v(" "),t._m(11),t._m(12),t._v(" "),t._m(13),t._m(14),t._v(" "),t._m(15),t._v(" "),t._m(16),t._v(" "),t._m(17),t._v(" "),t._m(18),t._v(" "),e("p",[t._v('Nmap ("Network Mapper") is an open source tool for network exploration\nand security auditing. It was designed to rapidly scan large networks,\nalthough it works fine against single host. (...)')]),t._v(" "),t._m(19),t._v(" "),t._m(20),t._v(" "),t._m(21),t._v(" "),t._m(22),t._v(" "),e("p",[t._v("練習：block all outgoing HTTP connections")]),t._v(" "),t._m(23),t._v(" "),e("p",[t._v("練習：only allow icmp on port 892 from IP 192.0.0.1")]),t._v(" "),t._m(24),t._v(" "),t._m(25),t._v(" "),t._m(26),t._v(" "),e("p",[t._v("練習：create a ufw rule to block all outgoing HTTP connection")]),t._v(" "),t._m(27),t._v(" "),t._m(28),t._v(" "),t._m(29),t._v(" "),t._m(30),t._v(" "),t._m(31),t._v(" "),t._m(32),t._v(" "),t._m(33),t._v(" "),e("p",[t._v("The purpose of unattended-upgrades is to keep the computer current with the latest security (and other) updates automatically.")]),t._v(" "),e("p",[t._v("安裝：")]),t._v(" "),t._m(34),t._v(" "),t._m(35),t._v(" "),e("p",[t._v("設定：")]),t._v(" "),t._m(36),t._v(" "),t._m(37),t._v(" "),t._m(38),e("hr",{staticClass:"footnotes-sep"}),t._v(" "),e("section",{staticClass:"footnotes"},[e("ol",{staticClass:"footnotes-list"},[e("li",{staticClass:"footnote-item",attrs:{id:"fn1"}},[e("p",[e("a",{attrs:{href:"http://www.chiark.greenend.org.uk/~peterb/network/drop-vs-reject",target:"_blank",rel:"noopener noreferrer"}},[t._v("Drop versus Reject"),e("OutboundLink")],1),t._v(" "),e("a",{staticClass:"footnote-backref",attrs:{href:"#fnref1"}},[t._v("↩︎")])])]),t._v(" "),e("li",{staticClass:"footnote-item",attrs:{id:"fn2"}},[e("p",[e("a",{attrs:{href:"https://www.digitalocean.com/community/tutorials/ufw-essentials-common-firewall-rules-and-commands",target:"_blank",rel:"noopener noreferrer"}},[t._v("UFW Essentials: Common Firewall Rules and Commands"),e("OutboundLink")],1),t._v(" "),e("a",{staticClass:"footnote-backref",attrs:{href:"#fnref2"}},[t._v("↩︎")])])])])])])},[function(){var t=this.$createElement,s=this._self._c||t;return s("h1",{attrs:{id:"basic-vpc-security-set-up"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#basic-vpc-security-set-up","aria-hidden":"true"}},[this._v("#")]),this._v(" Basic VPC Security Set Up")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h5",{attrs:{id:"tags-security-vps"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tags-security-vps","aria-hidden":"true"}},[this._v("#")]),this._v(" tags: "),s("code",[this._v("security")]),this._v(", "),s("code",[this._v("VPS")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"_1-更新"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-更新","aria-hidden":"true"}},[this._v("#")]),this._v(" 1. 更新")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt")]),t._v(" update\n$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt")]),t._v(" upgrade\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"_2-如果原本是使用-root-登入，建議新增一位使用者"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-如果原本是使用-root-登入，建議新增一位使用者","aria-hidden":"true"}},[this._v("#")]),this._v(" 2. 如果原本是使用 root 登入，建議新增一位使用者")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 切換成 root")]),t._v("\n$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" -s\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# root 新增一位使用者")]),t._v("\n$ adduser "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$NEW_USER")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# grand $NEW_USER sudo access")]),t._v("\n$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("usermod")]),t._v(" -aG "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$NEW_USER")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 列出 group sudo 確認有該成員")]),t._v("\n$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("grep")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'sudo'")]),t._v(" /etc/group\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Switch to $NEW_USER")]),t._v("\n$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("su")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$NEW_USER")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 建立密碼")]),t._v("\n$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("passwd")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br"),e("span",{staticClass:"line-number"},[t._v("12")]),e("br"),e("span",{staticClass:"line-number"},[t._v("13")]),e("br"),e("span",{staticClass:"line-number"},[t._v("14")]),e("br"),e("span",{staticClass:"line-number"},[t._v("15")]),e("br"),e("span",{staticClass:"line-number"},[t._v("16")]),e("br"),e("span",{staticClass:"line-number"},[t._v("17")]),e("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[this._v("記得測一下新增的使用者能不能做 sudo 操作")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"_3-權限控管"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-權限控管","aria-hidden":"true"}},[this._v("#")]),this._v(" 3. 權限控管")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("留個後路，先為 root 設定密碼")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-bash line-numbers-mode"},[e("div",{staticClass:"highlight-lines"},[e("br"),e("br"),e("br"),e("br"),e("div",{staticClass:"highlighted"},[t._v(" ")]),e("br"),e("br"),e("br"),e("br"),e("br"),e("br")]),e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 先切換成 root")]),t._v("\n$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" -s\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# add a passwd for root")]),t._v("\n$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("passwd")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 依據提示操作")]),t._v("\nEnter new UNIX password:\nRetype new UNIX password:\npasswd: password updated successfully\n")])]),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("Disable root login")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-bash line-numbers-mode"},[e("div",{staticClass:"highlight-lines"},[e("br"),e("br"),e("br"),e("div",{staticClass:"highlighted"},[t._v(" ")]),e("br"),e("br"),e("br"),e("br"),e("br"),e("br"),e("br")]),e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("vi")]),t._v(" /etc/ssh/sshd_config\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 是否允許 root 管理者以 SSH 登入")]),t._v("\nPermitRootLogin no\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 是否允許以密碼登入, allow only ssh")]),t._v("\nPasswordAuthentication no\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 重新啟動 SSH 服務")]),t._v("\n$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("service")]),t._v(" sshd restart\n")])]),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("使用 private key ssh login")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("mkdir")]),t._v(" -p ~/.ssh\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 把 自己電腦 的 公鑰 貼到主機上的 authorized_keys 內")]),t._v("\n$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("vi")]),t._v(" ~/.ssh/authorized_keys\n\n$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("cat")]),t._v(" ~/.ssh/"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${key}")]),t._v(".pub "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" pbcopy\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# OR, 一條指令結束")]),t._v("\n$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("cat")]),t._v(" ~/.ssh/my_key.pub "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("ssh")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$USERNAME@")]),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$SERVER_IP")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mkdir -p ~/.ssh && cat >> ~/.ssh/authorized_keys"')]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"_4-防火牆"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-防火牆","aria-hidden":"true"}},[this._v("#")]),this._v(" 4. 防火牆")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"warning custom-block"},[s("p",{staticClass:"custom-block-title"},[this._v("WARNING")]),this._v(" "),s("p",[this._v("這些都是危險操作")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"nmap"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#nmap","aria-hidden":"true"}},[this._v("#")]),this._v(" nmap")])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[this._v("Network exploration tool and security / port scanner")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("根據 "),s("code",[this._v("man")]),this._v(":")])},function(){var t=this.$createElement,s=this._self._c||t;return s("pre",[s("code",[this._v("$ nmap YOUR_IP \n")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"iptable"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#iptable","aria-hidden":"true"}},[this._v("#")]),this._v(" iptable")])},function(){var t=this.$createElement,s=this._self._c||t;return s("pre",[s("code",[this._v("$ sudo iptables -A INPUT -p tcp --dport 22 -j ACCEPT\n")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ul",[e("li",[e("code",[t._v("-A")]),t._v(" append rule")]),t._v(" "),e("li",[e("code",[t._v("-p")]),t._v(" protocol")]),t._v(" "),e("li",[e("code",[t._v("--dport")]),t._v(" destination port")]),t._v(" "),e("li",[e("code",[t._v("-j")]),t._v(" --jump target, This specifies the target of the rule; i.e., what to do if the packet matches it. (DROP, REJECT"),e("sup",{staticClass:"footnote-ref"},[e("a",{attrs:{href:"#fn1",id:"fnref1"}},[t._v("[1]")])]),t._v(", ACCEPT, LOG)")]),t._v(" "),e("li",[e("code",[t._v("-s")]),t._v(" --source")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("pre",[s("code",[this._v("$ sudo iptables -A OUTPUT -p tcp --dport 80 -j REJECT\n")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("pre",[s("code",[this._v("$ sudo iptables -A INPUT -s 192.0.0.1 -p icmp --dport 892 -j ACCEPT  \n")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"ufw"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ufw","aria-hidden":"true"}},[this._v("#")]),this._v(" ufw")])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[this._v("uncomplicated firewall")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("pre",[s("code",[this._v("$ sudo ufw reject out http\n")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("參考連結"),s("sup",{staticClass:"footnote-ref"},[s("a",{attrs:{href:"#fn2",id:"fnref2"}},[this._v("[2]")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"gui"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#gui","aria-hidden":"true"}},[this._v("#")]),this._v(" GUI")])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[this._v("以 AWS security group 為例")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:"https://docs.bitnami.com/images/img/platforms/aws/close-firewall-3.png",alt:""}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"_5-自動化-update-patch"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-自動化-update-patch","aria-hidden":"true"}},[this._v("#")]),this._v(" 5. 自動化 update / patch")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"unattendedupgrades"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#unattendedupgrades","aria-hidden":"true"}},[this._v("#")]),this._v(" UnattendedUpgrades")])},function(){var t=this.$createElement,s=this._self._c||t;return s("pre",[s("code",[this._v("$ sudo apt install unattended-upgrades\n")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"tip custom-block"},[s("p",{staticClass:"custom-block-title"},[this._v("TIP")]),this._v(" "),s("p",[this._v("建議僅更新安全性 Patch")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("pre",[s("code",[this._v("$ sudo cat /etc/apt/apt.conf.d/20auto-upgrades\n")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:"https://user-images.githubusercontent.com/44891368/53754663-94703c00-3eef-11e9-99b2-23b2fc9367c0.png",alt:""}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"page-nav"},[s("p",{staticClass:"inner"},[s("span",{staticClass:"prev"},[this._v("\n      ← "),s("a",{staticClass:"prev router-link-active",attrs:{href:"/blog_vuepress/articles/"}},[this._v("\n          回文章列表\n        ")])])])])}],!1,null,null,null);s.default=n.exports}}]);